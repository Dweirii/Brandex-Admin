# إعداد نظام إرسال البريد الإلكتروني للمدير

## المتطلبات

### 1. تثبيت مكتبة Resend
```bash
npm install resend
```

### 2. إعداد حساب Resend
1. اذهب إلى [resend.com](https://resend.com)
2. أنشئ حساب جديد
3. احصل على API Key
4. أضف نطاقك (domain) للتحقق منه

### 3. إضافة المتغيرات البيئية
أضف هذه المتغيرات إلى ملف `.env.local`:

```env
# Email (Resend)
RESEND_API_KEY=your_resend_api_key

# Admin Dashboard URL
ADMIN_DASHBOARD_URL=http://localhost:3001

# Admin Email (اختياري - القيمة الافتراضية: zaid@dweiri.dev)
ADMIN_EMAIL=zaid@dweiri.dev
```

### 4. تحديث عنوان المرسل
في ملف `lib/email.ts`، قم بتحديث عنوان المرسل:

```typescript
from: 'Your Store Name <noreply@yourdomain.com>',
```

## كيفية عمل النظام

### عند اكتمال الدفع (Stripe)
1. يتم استقبال webhook من Stripe
2. تحديث حالة الطلب إلى "مدفوع"
3. إرسال إشعار للمدير (zaid@dweiri.dev)
4. إرسال تأكيد للعميل

### عند اكتمال الدفع (PayPal)
1. يتم استقبال webhook من PayPal
2. تحديث حالة الطلب إلى "مدفوع"
3. إرسال إشعار للمدير (zaid@dweiri.dev)
4. إرسال تأكيد للعميل

## محتوى البريد الإلكتروني

### بريد إلكتروني المدير يحتوي على:
- رقم الطلب
- تاريخ الطلب
- طريقة الدفع
- المبلغ الإجمالي
- معلومات العميل
- قائمة المنتجات
- رابط للوصول إلى لوحة التحكم

### بريد إلكتروني العميل يحتوي على:
- تأكيد الطلب
- تفاصيل الطلب
- قائمة المنتجات المطلوبة
- رسالة شكر

## استكشاف الأخطاء

### إذا لم يتم إرسال البريد الإلكتروني:
1. تحقق من صحة `RESEND_API_KEY`
2. تحقق من إعدادات النطاق في Resend
3. تحقق من سجلات الأخطاء في console
4. تأكد من أن بريد إلكتروني المدير صحيح

### لتغيير بريد إلكتروني المدير:
1. أضف متغير البيئة `ADMIN_EMAIL` في ملف `.env.local`
2. أو قم بتعديل القيمة الافتراضية في ملف `lib/email.ts`

## تخصيص قوالب البريد الإلكتروني

يمكنك تخصيص قوالب البريد الإلكتروني في ملف `lib/email.ts`:

- تغيير التصميم
- إضافة المزيد من المعلومات
- تغيير اللغة
- إضافة شعار المتجر

## ملاحظات مهمة

- البريد الإلكتروني للمدير ثابت: `zaid@dweiri.dev`
- يمكن تغييره عبر متغير البيئة `ADMIN_EMAIL`
- لا يحتاج النظام للوصول إلى Clerk للحصول على بريد إلكتروني المدير
- يتم إرسال البريد الإلكتروني تلقائياً عند اكتمال أي دفع 